(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4654:function(){},7546:function(e,t,r){Promise.resolve().then(r.bind(r,7145))},7145:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});var a=r(7437),l=r(2265),n=r(3901),o=r.n(n),i=r(8254),s=r.n(i);r(8262),r(9399);var c=r(2298),u=r(2832),d=r(9217),h=r(5950),m=function(e){let{transectData:t}=e,r=(0,l.useRef)();return(0,l.useEffect)(()=>{if(t&&t.length>0){let e=h.g({width:r.current.clientWidth,height:r.current.clientHeight,y:{label:"Elevation (m)"},marks:[h.jv(t,{x:(e,t)=>t,y:"elevation"})]});return r.current.innerHTML="",r.current.append(e),()=>e.remove()}},[t]),(0,a.jsx)("div",{ref:r,style:{width:"100%",height:"100%"}})};o().accessToken="pk.eyJ1IjoiaGFrYWkiLCJhIjoiY2lyNTcwYzY5MDAwZWc3bm5ubTdzOWtzaiJ9.6QhxH6sQEgK634qO7a8MoQ";let g={"Ortho Apr. '21":"https://goose.hakai.org/titiler/cog/tiles/{z}/{x}/{y}?bidx=1&bidx=2&bidx=3&url=https://public-aco-data.s3.amazonaws.com/3030_ElliotCreekLandslide/21_3030_01_ElliotCreekLandslide_ORTHO_CSRS_UTM10_HTv2_cog.tif","DEM Apr. '21":"https://goose.hakai.org/titiler/cog/tiles/{z}/{x}/{y}?colormap_name=gist_earth&rescale=-10,2500&nodata=-340282346638528859811704183484516925440&bidx=1&resampling=nearest&return_mask=true&url=https://public-aco-data.s3.amazonaws.com/3030_ElliotCreekLandslide/21_3030_01_ElliotCreekLandslide_DEM_1m_CSRS_UTM10_HTv2_cog.tif","HS Apr. '21":'https://goose.hakai.org/titiler/cog/tiles/{z}/{x}/{y}?algorithm=hillshade&algorithm_params={"angle_altitude":45}&nodata=-340282346638528859811704183484516925440&bidx=1&resampling=nearest&return_mask=true&url=https://public-aco-data.s3.amazonaws.com/3030_ElliotCreekLandslide/21_3030_01_ElliotCreekLandslide_DEM_1m_CSRS_UTM10_HTv2_cog.tif',"Ortho Jul. '21":"https://goose.hakai.org/titiler/cog/tiles/{z}/{x}/{y}?bidx=1&bidx=2&bidx=3&url=https://public-aco-data.s3.amazonaws.com/3030_ElliotCreekLandslide/21_3030_02_ElliotCreekLandslide_ORTHO_CSRS_UTM10_HTv2_cog.tif","Ortho Oct. '21":"https://goose.hakai.org/titiler/cog/tiles/{z}/{x}/{y}?bidx=1&bidx=2&bidx=3&url=https://public-aco-data.s3.amazonaws.com/3030_ElliotCreekLandslide/21_3030_03_ElliotCreekLandslide_ORTHO_CSRS_UTM10_HTv2_cog.tif"},_=Object.keys(g)[0];function p(e,t){let r=(0,l.useRef)(null),n=(0,l.useRef)(null),i=(0,l.useRef)(null),[h,p]=(0,l.useState)(-124.6717),[x,b]=(0,l.useState)(50.9013),[f,k]=(0,l.useState)(12),[v,y]=(0,l.useState)(60),[C,S]=(0,l.useState)(0),E=(0,l.useRef)(),[w,j]=(0,l.useState)(_),[T,z]=(0,l.useState)(null),[L,O]=(0,l.useState)(null),[R,M]=(0,l.useState)(!1),N=async(e,t)=>{let r="https://goose.hakai.org/titiler/cog/point/".concat(e,",").concat(t,"?url=").concat(encodeURIComponent("https://public-aco-data.s3.amazonaws.com/3030_ElliotCreekLandslide/21_3030_01_ElliotCreekLandslide_DEM_1m_CSRS_UTM10_HTv2_cog.tif"));try{let e=await fetch(r),t=await e.json();if(t&&t.values&&t.values.length>0){let e=t.values[0];z(e)}else z(null)}catch(e){console.error("Error fetching elevation data:",e),z(null)}},H=e=>{n.current&&(n.current.rotateTo(e/100%360,{duration:0}),E.current=requestAnimationFrame(H))},F=(0,l.useCallback)(()=>{E.current&&(cancelAnimationFrame(E.current),E.current=null)},[]);(0,l.useEffect)(()=>{if(n.current)return;n.current=new(o()).Map({container:r.current,style:"mapbox://styles/mapbox/light-v11",center:[h,x],zoom:f,pitch:v}),n.current.on("move",()=>{p(n.current.getCenter().lng.toFixed(4)),b(n.current.getCenter().lat.toFixed(4)),k(n.current.getZoom().toFixed(2)),y(n.current.getPitch().toFixed(2)),S(n.current.getBearing().toFixed(2))}),n.current.on("touchstart",F),n.current.on("contextmenu",F),n.current.on("load",()=>{i.current=new(s())({displayControlsDefault:!1,controls:{line_string:!0,trash:!0}}),n.current.addControl(i.current),n.current.on("draw.create",t),n.current.on("draw.update",t),n.current.on("draw.delete",a),n.current.addSource("mapbox-dem",{type:"raster-dem",url:"mapbox://mapbox.mapbox-terrain-dem-v1",tileSize:512,maxzoom:14}),n.current.setTerrain({source:"mapbox-dem",exaggeration:1}),Object.keys(g).forEach(e=>{let t=g[e];n.current.addSource(e,{type:"raster",tiles:[t],tileSize:512})}),n.current.addLayer({id:w,type:"raster",source:w,paint:{}},"building")});let e=async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,a=(0,c.Tu)([e,t]),l=(0,d.Z)(a,{units:"kilometers"}),n=[];for(let e=0;e<=r;e++){let t=u.$(a,l/r*e,{units:"kilometers"});n.push(t.geometry.coordinates)}let o=await Promise.all(n.map(async e=>{let[t,r]=e,a="https://goose.hakai.org/titiler/cog/point/".concat(t,",").concat(r,"?url=").concat(encodeURIComponent("https://public-aco-data.s3.amazonaws.com/3030_ElliotCreekLandslide/21_3030_01_ElliotCreekLandslide_DEM_1m_CSRS_UTM10_HTv2_cog.tif")),l=await fetch(a),n=await l.json();return{lng:t,lat:r,elevation:n.values[0]}}));return o};function t(t){let r=i.current.getAll(),a=r.features.filter(e=>"LineString"===e.geometry.type);if(a.length>0){let t=a[0],r=t.geometry.coordinates,l=r[0],n=r[r.length-1];e(l,n).then(e=>{console.log(e.filter(e=>e.elevation>0)),O(e.filter(e=>e.elevation>0)),M(!0)})}}function a(){O(null),M(!1)}n.current.on("click",e=>{let{lng:t,lat:r}=e.lngLat;N(t,r)})});let U=e=>{n.current.removeLayer(w),n.current.addLayer({id:e,type:"raster",source:e,paint:{}},"building"),j(e)};return(0,a.jsx)("main",{className:"w-screen min-h-screen",children:(0,a.jsxs)("div",{className:"absolute top-0 bottom-0 left-0 right-0",children:[(0,a.jsx)("div",{className:"absolute top-0 left-0 m-4 z-10",children:(0,a.jsxs)("div",{className:"flex flex-col bg-base-200 w-40 p-2 rounded-box",children:[(0,a.jsx)("h3",{className:"label-text text-lg font-bold",children:"Layers"}),Object.keys(g).map(e=>(0,a.jsx)("div",{className:"form-control",children:(0,a.jsxs)("label",{className:"label cursor-pointer",children:[(0,a.jsx)("span",{className:"label-text",children:e}),(0,a.jsx)("input",{type:"radio",name:"radio-10",className:"radio checked:bg-red-500",checked:e===w,onClick:()=>U(e)})]})},e))]})}),(0,a.jsxs)("div",{className:"absolute top-4 left-1/2 transform -translate-x-1/2 z-10 bg-base-200 p-2 rounded-box",children:[(0,a.jsx)("h3",{className:"label-text text-lg font-bold",children:"Elevation"}),(0,a.jsx)("p",{className:"label-text",children:null!==T?"".concat(T.toFixed(2)," meters"):"Click on the map to get elevation"})]}),(0,a.jsxs)("div",{style:{position:"relative",width:"100%",height:"100vh"},children:[(0,a.jsx)("div",{ref:r,style:{width:"100%",height:"100%"}}),L&&(0,a.jsx)("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"30%",backgroundColor:"rgba(255, 255, 255, 0.8)",zIndex:10,padding:"10px",boxSizing:"border-box"},children:(0,a.jsx)(m,{transectData:L})})]})]})})}}},function(e){e.O(0,[415,457,594,971,472,744],function(){return e(e.s=7546)}),_N_E=e.O()}]);